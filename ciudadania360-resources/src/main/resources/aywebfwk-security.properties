# Configuración de seguridad Ciudadanía360
# ==========================================

# Configuración de autenticación GCA
security.gca.enabled=${GCA_ENABLED:true}
security.gca.cas.url=${GCA_CAS_URL:https://cas.valencia.es/cas}
security.gca.service.url=${GCA_SERVICE_URL:https://ciudadania360.valencia.es}
security.gca.timeout=${GCA_TIMEOUT:30000}

# Configuración de sesiones
security.session.timeout=${SESSION_TIMEOUT:1800}
security.session.max-sessions=${MAX_SESSIONS:1}
security.session.invalidate-on-timeout=true
security.session.fixation-protection=migrateSession

# Configuración de CSRF
security.csrf.enabled=true
security.csrf.token-header=X-CSRF-TOKEN
security.csrf.parameter-name=_csrf

# Configuración de CORS
security.cors.enabled=true
security.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://ciudadania360.valencia.es}
security.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
security.cors.allowed-headers=*
security.cors.allow-credentials=true
security.cors.max-age=3600

# Configuración de headers de seguridad
security.headers.frame-options=DENY
security.headers.content-type-options=nosniff
security.headers.xss-protection=1; mode=block
security.headers.referrer-policy=strict-origin-when-cross-origin
security.headers.content-security-policy=default-src 'self'

# Configuración de SSL/TLS
security.ssl.enabled=${SSL_ENABLED:false}
security.ssl.keystore=${SSL_KEYSTORE:}
security.ssl.keystore-password=${SSL_KEYSTORE_PASSWORD:}
security.ssl.key-alias=${SSL_KEY_ALIAS:}
security.ssl.key-password=${SSL_KEY_PASSWORD:}

# Configuración de roles y permisos
security.roles.admin=ADMIN
security.roles.empleado=EMPLEADO
security.roles.ciudadano=CIUDADANO
security.roles.guest=GUEST

# Configuración de permisos por funcionalidad
security.permissions.ciudadano.read=CIUDADANO,EMPLEADO,ADMIN
security.permissions.ciudadano.write=EMPLEADO,ADMIN
security.permissions.ciudadano.delete=ADMIN

security.permissions.solicitud.read=CIUDADANO,EMPLEADO,ADMIN
security.permissions.solicitud.write=CIUDADANO,EMPLEADO,ADMIN
security.permissions.solicitud.delete=ADMIN

security.permissions.comunicacion.read=CIUDADANO,EMPLEADO,ADMIN
security.permissions.comunicacion.write=EMPLEADO,ADMIN
security.permissions.comunicacion.delete=ADMIN

security.permissions.informacion.read=CIUDADANO,EMPLEADO,ADMIN
security.permissions.informacion.write=EMPLEADO,ADMIN
security.permissions.informacion.delete=ADMIN

security.permissions.ia.read=CIUDADANO,EMPLEADO,ADMIN
security.permissions.ia.write=EMPLEADO,ADMIN
security.permissions.ia.delete=ADMIN

# Configuración de auditoría de seguridad
security.audit.enabled=true
security.audit.login-attempts=true
security.audit.failed-login-threshold=5
security.audit.lockout-duration=300
security.audit.password-policy.enabled=true
security.audit.password-policy.min-length=8
security.audit.password-policy.require-uppercase=true
security.audit.password-policy.require-lowercase=true
security.audit.password-policy.require-numbers=true
security.audit.password-policy.require-special-chars=true

# Configuración de encriptación
security.encryption.algorithm=AES
security.encryption.key=${ENCRYPTION_KEY:}
security.encryption.iv=${ENCRYPTION_IV:}

# Configuración de tokens JWT (si se implementa)
security.jwt.enabled=false
security.jwt.secret=${JWT_SECRET:}
security.jwt.expiration=${JWT_EXPIRATION:3600}
security.jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:86400}

# Configuración de rate limiting
security.rate-limit.enabled=true
security.rate-limit.requests-per-minute=${RATE_LIMIT_RPM:60}
security.rate-limit.burst-capacity=${RATE_LIMIT_BURST:100}

# Configuración de IP whitelist (para administradores)
security.ip-whitelist.enabled=false
security.ip-whitelist.addresses=${IP_WHITELIST:}

# Configuración de logging de seguridad
security.logging.enabled=true
security.logging.level=INFO
security.logging.include-request-headers=false
security.logging.include-response-headers=false
